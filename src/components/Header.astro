---
import Icon from './Icon.astro';
import ThemeToggle from './ThemeToggle.astro';
---

<header class="fixed top-0 left-0 w-full bg-light-300/90 dark:bg-dark-200/90 backdrop-blur-sm z-50 transition-colors duration-300">
  <div class="container mx-auto px-4 py-4 flex items-center justify-between">
    <!-- Logo -->
    <a href="#hero" class="flex items-center gap-2 text-dark-100 dark:text-light-100 font-brand text-xl" style="font-family: Cambria, serif;">
      <Icon icon="terminal-window" color="var(--accent-regular)" size="1.6em" gradient />
      <span>Satvik Jonnalagadda</span>
    </a>

    <!-- Mobile Menu Button -->
    <button id="mobile-menu-button" class="md:hidden text-dark-100 dark:text-light-100">
      <Icon icon="list" size="1.5em" />
    </button>

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex items-center gap-6">
      <ul class="flex items-center gap-6">
        <li><a href="#hero" class="nav-link">Home</a></li>
        <li><a href="#education" class="nav-link">Education</a></li>
        <li><a href="#experience" class="nav-link">Experience</a></li>
        <li><a href="#projects" class="nav-link">Projects</a></li>
        <li><a href="#certifications" class="nav-link">Certifications</a></li>
        <li><a href="#interests" class="nav-link">Interests</a></li>
      </ul>

      <div class="flex items-center gap-3">
        <a href="https://github.com/satvikjo" target="_blank" class="icon-btn" aria-label="GitHub">
          <Icon icon="github-logo" size="1.5em" />
        </a>
        <a href="https://linkedin.com/in/satvik-jonnalagadda" target="_blank" class="icon-btn" aria-label="LinkedIn">
          <Icon icon="linkedin-logo" size="1.5em" />
        </a>
        <ThemeToggle />
      </div>
    </nav>

    <!-- Mobile Navigation Menu -->
    <div id="mobile-menu" class="fixed inset-0 bg-light-300 dark:bg-dark-200 z-50 flex flex-col items-center justify-center transform translate-x-full transition-transform duration-300">
      <button id="close-menu" class="absolute top-6 right-6 text-dark-100 dark:text-light-100">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <ul class="flex flex-col items-center gap-6 text-xl">
        <li><a href="#hero" class="mobile-nav-link">Home</a></li>
        <li><a href="#education" class="mobile-nav-link">Education</a></li>
        <li><a href="#experience" class="mobile-nav-link">Experience</a></li>
        <li><a href="#projects" class="mobile-nav-link">Projects</a></li>
        <li><a href="#certifications" class="mobile-nav-link">Certifications</a></li>
        <li><a href="#interests" class="mobile-nav-link">Interests</a></li>
      </ul>
      <div class="flex items-center gap-4 mt-8">
        <a href="https://github.com/satvikjo" target="_blank" class="icon-btn" aria-label="GitHub">
          <Icon icon="github-logo" size="1.5em" />
        </a>
        <a href="https://linkedin.com/in/satvik-jonnalagadda" target="_blank" class="icon-btn" aria-label="LinkedIn">
          <Icon icon="linkedin-logo" size="1.5em" />
        </a>
        <ThemeToggle />
      </div>
    </div>
  </div>
</header>

<style>
  .nav-link {
    position: relative;
    color: var(--gray-200);
    font-weight: 500;
    transition: color 0.3s ease;
  }

  .nav-link::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--gradient-accent);
    transition: width 0.3s ease;
  }

  .nav-link:hover {
    color: var(--accent-regular);
  }

  .nav-link:hover::after {
    width: 100%;
  }

  .mobile-nav-link {
    color: var(--gray-200);
    font-weight: 500;
    transition: color 0.3s ease;
    padding: 0.5rem 1rem;
  }

  .mobile-nav-link:hover {
    color: var(--accent-regular);
  }
</style>

<script>
  // Mobile menu functionality
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const closeMenuButton = document.getElementById('close-menu');
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');

  if (mobileMenuButton && mobileMenu && closeMenuButton) {
    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.remove('translate-x-full');
      document.body.style.overflow = 'hidden';
    });

    closeMenuButton.addEventListener('click', () => {
      mobileMenu.classList.add('translate-x-full');
      document.body.style.overflow = '';
    });

    mobileNavLinks.forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu.classList.add('translate-x-full');
        document.body.style.overflow = '';
      });
    });
  }

  // Active link highlighting
  const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');
  const sections = document.querySelectorAll('section[id]');

  function highlightNavLink() {
    const scrollPosition = window.scrollY;

    sections.forEach(section => {
      const sectionTop = section.offsetTop - 100;
      const sectionHeight = section.offsetHeight;
      const sectionId = section.getAttribute('id');

      if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
        navLinks.forEach(link => {
          link.classList.remove('text-primary-light', 'dark:text-primary-dark');
          if (link.getAttribute('href') === `#${sectionId}`) {
            link.classList.add('text-primary-light', 'dark:text-primary-dark');
          }
        });
      }
    });
  }

  window.addEventListener('scroll', highlightNavLink);
  document.addEventListener('DOMContentLoaded', highlightNavLink);
</script>